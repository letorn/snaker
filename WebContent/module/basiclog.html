<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>基础日志</title>
<script type="text/javascript" src="${ctx}/common/jquery.min.js"></script>
<script type="text/javascript" src="${ctx}/common/jquery.custom.js"></script>
<link rel="stylesheet" type="text/css" href="${ctx}/common/easyui/themes/default/easyui.css">
<link rel="stylesheet" type="text/css" href="${ctx}/common/easyui/themes/icon.css">
<script type="text/javascript" src="${ctx}/common/easyui/jquery.easyui.min.js"></script>
<script type="text/javascript" src="${ctx}/common/easyui/locale/easyui-lang-zh_CN.js"></script>
</head>
<body>
<div data-options="fit:true">
	<table id="module-basiclog-table" class="easyui-datagrid" data-options="footer:'#module-basiclog-table-pager'" style="width:1000px;height:650px"></table>
	<div id="module-basiclog-table-pager" class="easyui-pagination"></div>
</div>
<script type="text/javascript">
	$(function() {
		$('#module-basiclog-table-pager').pagination({
			showPageList: false,
			displayMsg: '',
			total: 0,
			onBeforeRefresh: function(page, pageSize) {
				$(this).data("refresh", true);
			},
			onSelectPage: function(page, pageSize) {
				var $this = $(this), refresh = $this.data('refresh');
				$.getJSON('${ctx}/workflow/record', {
					process: '${process}',
					instance: '${instance}',
					module: '${module}',
					page: page,
					refresh: refresh
				}, function(resp) {
					if (refresh) {
						$('#module-basiclog-table').datagrid({
							columns: [resp.headers.map(function(row) {return {title: row.name, field: row.name, width: 100, formatter: $.encodeHtml}})],
							data: resp.rows
						});
						$this.pagination('refresh', {
							total: resp.pageTotal * 10
						})
						$this.data('refresh', false);
					} else {
						$('#module-basiclog-table').datagrid('loadData', resp.rows);
					}
				});
			}
		});
	});
</script>
</body>
</html>